-- UI LIBRARY
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local playerGui = LocalPlayer:WaitForChild("PlayerGui")

local Library = {}
Library.__index = Library

-- Create Window
function Library:CreateWindow(guiName, sidebarTitleText)
    local self = setmetatable({}, Library)

    -- ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = guiName or "DarkMirrorClassicUI"
    self.ScreenGui.Parent = playerGui
    self.ScreenGui.ResetOnSpawn = false

    -- Show/Hide Button
    local showIcon = "rbxassetid://YOUR_SHOW_ICON_ID"
    local hideIcon = "rbxassetid://YOUR_HIDE_ICON_ID"
    local showHideBtn = Instance.new("ImageButton")
    showHideBtn.Size = UDim2.new(0, 60, 0, 60)
    showHideBtn.Position = UDim2.new(0, 24, 0.5, -30)
    showHideBtn.AnchorPoint = Vector2.new(0, 0.5)
    showHideBtn.Image = hideIcon
    showHideBtn.Parent = self.ScreenGui
    showHideBtn.ZIndex = 99

    Instance.new("UIStroke", showHideBtn).Color = Color3.fromRGB(255,0,0)

    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 480, 0, 320)
    mainFrame.Position = UDim2.new(0.5, -240, 0.5, -160)
    mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    mainFrame.BackgroundTransparency = 0.25
    mainFrame.Parent = self.ScreenGui
    self.MainFrame = mainFrame

    Instance.new("UIStroke", mainFrame).Color = Color3.fromRGB(255,0,0)

    -- Sidebar
    local sidebar = Instance.new("ScrollingFrame")
    sidebar.Size = UDim2.new(0, 154, 1, 0)
    sidebar.ScrollBarThickness = 4
    sidebar.BackgroundColor3 = Color3.fromRGB(24,24,24)
    sidebar.BackgroundTransparency = 0.3
    sidebar.Active = true
    sidebar.Parent = mainFrame
    self.Sidebar = sidebar

    local sidebarList = Instance.new("UIListLayout", sidebar)
    sidebarList.Padding = UDim.new(0, 8)

    -- Title
    local sidebarTitle = Instance.new("TextLabel")
    sidebarTitle.Size = UDim2.new(1, -24, 0, 38)
    sidebarTitle.Position = UDim2.new(0, 12, 0, 8)
    sidebarTitle.BackgroundTransparency = 1
    sidebarTitle.Text = sidebarTitleText or "ClassicBruh"
    sidebarTitle.Font = Enum.Font.GothamBold
    sidebarTitle.TextSize = 24
    sidebarTitle.TextColor3 = Color3.fromRGB(255,255,255)
    sidebarTitle.TextXAlignment = Enum.TextXAlignment.Left
    sidebarTitle.Parent = sidebar

    -- Content
    local content = Instance.new("Frame")
    content.Size = UDim2.new(1, -166, 1, -20)
    content.Position = UDim2.new(0, 154, 0, 10)
    content.BackgroundColor3 = Color3.fromRGB(20,20,20)
    content.BackgroundTransparency = 0.35
    content.Parent = mainFrame
    self.Content = content

    self.Tabs = {}
    self.Buttons = {}

    -- Show/Hide toggle
    local uiVisible = true
    showHideBtn.MouseButton1Click:Connect(function()
        uiVisible = not uiVisible
        mainFrame.Visible = uiVisible
        showHideBtn.Image = uiVisible and hideIcon or showIcon
    end)

    return self
end

-- Create Tab
function Library:CreateTab(tabName)
    local tabFrame = Instance.new("ScrollingFrame")
    tabFrame.Size = UDim2.new(1,0,1,0)
    tabFrame.BackgroundTransparency = 1
    tabFrame.ScrollBarThickness = 6
    tabFrame.Visible = false
    tabFrame.Parent = self.Content

    local layout = Instance.new("UIListLayout", tabFrame)
    layout.Padding = UDim.new(0, 8)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    self.Tabs[tabName] = tabFrame

    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -12, 0, 36)
    btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
    btn.Text = tabName
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamMedium
    btn.TextSize = 16
    btn.TextXAlignment = Enum.TextXAlignment.Left
    btn.Parent = self.Sidebar

    btn.MouseButton1Click:Connect(function()
        for _, f in pairs(self.Tabs) do f.Visible = false end
        tabFrame.Visible = true
        for _, b in pairs(self.Buttons) do b.BackgroundColor3 = Color3.fromRGB(30,30,30) end
        btn.BackgroundColor3 = Color3.fromRGB(60,0,0)
    end)

    table.insert(self.Buttons, btn)
    if #self.Buttons == 1 then
        tabFrame.Visible = true
        btn.BackgroundColor3 = Color3.fromRGB(60,0,0)
    end

    return setmetatable({Frame = tabFrame}, {__index = self})
end

-- Section
function Library:CreateSection(tab, text)
    local section = Instance.new("TextLabel")
    section.Size = UDim2.new(0.9,0,0,32)
    section.BackgroundTransparency = 1
    section.Text = text
    section.Font = Enum.Font.GothamBold
    section.TextSize = 20
    section.TextColor3 = Color3.fromRGB(255,50,50)
    section.TextXAlignment = Enum.TextXAlignment.Left
    section.Parent = tab.Frame
end

-- Button
function Library:CreateButton(tab, text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0,80,0,24)
    btn.BackgroundColor3 = Color3.fromRGB(0,100,0)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 12
    btn.Parent = tab.Frame

    btn.MouseButton1Click:Connect(callback or function() end)
    return btn
end

-- (Same pattern â†’ CreateToggle, CreateSlider, CreateDropdown, CreateTextbox can be added here)

return Library
